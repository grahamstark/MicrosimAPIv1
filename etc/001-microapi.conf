<VirtualHost *:80>
        ServerName microapi.virtual-worlds.scot
        Redirect permanent / https://microapi.virtual-worlds.scot/
</VirtualHost>

<IfModule mod_ssl.c>

<VirtualHost *:443>

	ServerName microapi.virtual-worlds.scot
	ServerAdmin webmaster@localhost
	DocumentRoot /var/www/microapi/
	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/microapi.log combined

	RewriteEngine on
	RewriteCond %{REQUEST_URI} ^/ [NC]
	RewriteRule /(.*) http://localhost:8999/$1 [P,QSA]

	SSLCertificateFile /etc/letsencrypt/live/microapi.virtual-worlds.scot/fullchain.pem
	SSLCertificateKeyFile /etc/letsencrypt/live/microapi.virtual-worlds.scot/privkey.pem

	Header always set Strict-Transport-Security "max-age=31536000;includeSubdomains;"
	Header set X-Frame-Options "SAMEORIGIN"
	Header set X-Content-Type-Options "nosniff"
	Header always set Referrer-Policy "same-origin"
	Header always set Permissions-Policy "geolocation=(),midi=(),sync-xhr=(),microphone=(),camera=(),magnetometer=(),gyroscope=(),fullscreen=(self),payment=()"
	Header set Content-Security-Policy "default-src 'self' localhost:8999; script-src 'self' 'unsafe-inline' 'unsafe-eval';sty
le-src 'self' 'unsafe-inline' ; font-src 'self' 'unsafe-inline'  "

</VirtualHost>

</IfModule>
